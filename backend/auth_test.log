2025-07-30 10:14:06,270 - app.db.session - INFO - Loading environment from: C:\Users\kunal\Downloads\EmergentIntelliTest-main\backend\.env
2025-07-30 10:14:06,272 - app.db.session - INFO - Database URL configured
2025-07-30 10:14:06,552 - passlib.utils.compat - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-07-30 10:14:06,553 - passlib.utils.compat - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-07-30 10:14:06,553 - passlib.utils.compat - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-07-30 10:14:06,558 - passlib.registry - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-07-30 10:14:07,390 - app.main - INFO - Initializing API routers...
2025-07-30 10:14:07,405 - app.main - INFO - API routers initialized successfully
2025-07-30 10:14:07,407 - auth_test - INFO - Successfully imported required modules
2025-07-30 10:14:07,409 - auth_test - INFO - Starting authentication tests...
2025-07-30 10:14:07,409 - auth_test - INFO - Testing password hashing and verification...
2025-07-30 10:14:07,410 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\kunal\AppData\Roaming\Python\Python312\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-30 10:14:07,412 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-30 10:14:07,412 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-30 10:14:08,648 - auth_test - INFO - Password hashing and verification tests passed
2025-07-30 10:14:08,650 - asyncio - DEBUG - Using proactor: IocpProactor
2025-07-30 10:14:08,653 - auth_test - INFO - Testing AuthService...
2025-07-30 10:14:09,479 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-07-30 10:14:09,481 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-07-30 10:14:09,622 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-07-30 10:14:09,623 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-07-30 10:14:09,764 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-07-30 10:14:09,764 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-07-30 10:14:09,908 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-07-30 10:14:09,917 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.email AS users_email, users.full_name AS users_full_name, users.hashed_password AS users_hashed_password, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-07-30 10:14:09,917 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] {'email_1': 'admin@example.com', 'param_1': 1}
2025-07-30 10:14:10,485 - auth_test - ERROR - Error in AuthService test: 401: Incorrect email or password
Traceback (most recent call last):
  File "C:\Users\kunal\Downloads\EmergentIntelliTest-main\backend\scripts\test_auth.py", line 176, in test_auth_service
    user = await auth_service.authenticate_user(test_email, "test123")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kunal\Downloads\EmergentIntelliTest-main\backend\app\auth\security.py", line 309, in authenticate_user
    raise HTTPException(
fastapi.exceptions.HTTPException: 401: Incorrect email or password
2025-07-30 10:14:10,485 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-07-30 10:14:10,565 - auth_test - INFO - === Starting API Authentication Test ===
2025-07-30 10:14:10,566 - auth_test - INFO - Looking for test user: admin@example.com
2025-07-30 10:14:10,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-07-30 10:14:10,567 - sqlalchemy.engine.Engine - INFO - SELECT * FROM public.users WHERE email = %(email)s
2025-07-30 10:14:10,567 - sqlalchemy.engine.Engine - INFO - [generated in 0.00159s] {'email': 'admin@example.com'}
2025-07-30 10:14:10,711 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-07-30 10:14:10,791 - auth_test - INFO - Prepared login data for admin@example.com
2025-07-30 10:14:10,791 - auth_test - INFO - 
=== Attempting to authenticate ===
2025-07-30 10:14:10,791 - auth_test - INFO - API Endpoint: /api/v1/auth/login
2025-07-30 10:14:10,791 - auth_test - INFO - Request Headers: {'Content-Type': 'application/x-www-form-urlencoded'}
2025-07-30 10:14:10,793 - auth_test - INFO - Request Data: {'username': 'admin@example.com', 'password': 'test123'}
2025-07-30 10:14:10,805 - asyncio - DEBUG - Using proactor: IocpProactor
2025-07-30 10:14:10,811 - httpx - INFO - HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 404 Not Found"
2025-07-30 10:14:10,819 - auth_test - INFO - 
=== Server Response ===
2025-07-30 10:14:10,819 - auth_test - INFO - Status Code: 404
2025-07-30 10:14:10,820 - auth_test - INFO - Response Headers: {'content-length': '22', 'content-type': 'application/json'}
2025-07-30 10:14:10,820 - auth_test - INFO - Response Body: {"detail":"Not Found"}
2025-07-30 10:14:10,822 - auth_test - INFO - === API Authentication Test Failed: Invalid status code ===
2025-07-30 10:14:10,824 - auth_test - INFO - 
=== Test Results ===
2025-07-30 10:14:10,824 - auth_test - INFO - Password Hashing: PASSED
2025-07-30 10:14:10,824 - auth_test - INFO - AuthService Authentication: FAILED
2025-07-30 10:14:10,824 - auth_test - INFO - API Authentication: FAILED
